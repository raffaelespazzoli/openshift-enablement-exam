export GUID=b409
export INSTALLER_VERSION=v0.15.0
export PULL_SECRET={"auths":{"cloud.openshift.com":{"auth":"b3BlbnNoaWZ0LXJlbGVhc2UtZGV2K3Jobmdwc3JzcGF6em9sMWViZ2NzYWxjcW96cnVpbGlsMHRja3Jkbm54Ok5CWjBSSzJLNEhDTjNUN0MzWUlHMVFGTUtYVzNVVk5WSExQWUdCMUxCN1JKMkxTS1ZCTkFYSjZCNDhWMDdEOTI=","email":"rspazzol@redhat.com"},"quay.io":{"auth":"b3BlbnNoaWZ0LXJlbGVhc2UtZGV2K3Jobmdwc3JzcGF6em9sMWViZ2NzYWxjcW96cnVpbGlsMHRja3Jkbm54Ok5CWjBSSzJLNEhDTjNUN0MzWUlHMVFGTUtYVzNVVk5WSExQWUdCMUxCN1JKMkxTS1ZCTkFYSjZCNDhWMDdEOTI=","email":"rspazzol@redhat.com"},"registry.connect.redhat.com":{"auth":"ODA3MTgzM3x1aGMtMUVCR0NTQWxjcU9aclVpbElsMHRja3JETk5YOmV5SmhiR2NpT2lKU1V6VXhNaUo5LmV5SnpkV0lpT2lJM09EWTROelZtTURrNE5qQTBNR1U1T1RneU5HSTVPV1kxWkRJM01UbGhNaUo5Lk05bTdNN1hJdjRQeW5GQnphOXUzYjk1X19raUJHWjh0T0h5VllEQ3pha3VnS2tnRFBXZWYtc2tpcWtVWW54S1piaGYtUHNwVkcwYlRHbHJWdUZHNGEzY1NuNjViRm9MdVZRa29Td3lIRnViTmpqVXlNZmpQZFhfZ0xLUXhTMk1ybS1VNFpfbmgyNklXVkhlUmEtLTVsQlplTzNXZGo1TVlFNEhEWjdZVU1zV0VpZk4tMzE4ZV90ZkhDaUhYaUJVNkZlMkl4dktTQW5iSmRWdWdJNlFHYVY2eXFpd2NvbGlYREZkRmRCbHBmTU1pYkxYUzFITWxtX0o4dVpOdlJTYTlMd2tCRlVTN1VucFJLdHRna1V6aDFWM29ySzVTS3hTLVEtWHd4M2M4X1pEQXg1TjVfd0NKQi1PQkdyLWJDSHRpZ3F4dlRyd29jdGI3Wkp2Z2ZWbVlQMzM1U1RwRXgxY3o2VXRjdjEyMnBJWG0wX1BUOU40ZW0wSnIzSDVvNEk2Yk9pQjJZd0VmRGNLUlBKeEpTYlJweGExMVJoa2w4YW01aG9sWVdQR1lZWl9xc09zUjQtWUZNM2hiQXhDNWR1aWlkdnpNdEdTdFhPeklKZ1Ffc0VESDU3OHJQMjRheDhiWG5rTTV0MWVySHdYTmw2WEdZRXNUY2pleTFmZ3R5RjBRSlA0MmhCeXZwV3BKYk9BWDBnRHlSQUVPRGdfckxUWFA5OWJTMGN3YWh3OENpRjJ0S01fVTlwOW5jMDh4S1lSWGNVODBLMWhnNzdINTNKaWN3c0ZZWkhRZUVLdzBaWU80S2FGYzdQVGxoajFxUFhuNUhmSk82aGx0cDhtR1JyaWoxTTQxWU1JcjFSOTgyS1dxRlB6bFFzbDNlNjNPUEh4aXZ5QzBncS0xei1B","email":"rspazzol@redhat.com"},"registry.redhat.io":{"auth":"ODA3MTgzM3x1aGMtMUVCR0NTQWxjcU9aclVpbElsMHRja3JETk5YOmV5SmhiR2NpT2lKU1V6VXhNaUo5LmV5SnpkV0lpT2lJM09EWTROelZtTURrNE5qQTBNR1U1T1RneU5HSTVPV1kxWkRJM01UbGhNaUo5Lk05bTdNN1hJdjRQeW5GQnphOXUzYjk1X19raUJHWjh0T0h5VllEQ3pha3VnS2tnRFBXZWYtc2tpcWtVWW54S1piaGYtUHNwVkcwYlRHbHJWdUZHNGEzY1NuNjViRm9MdVZRa29Td3lIRnViTmpqVXlNZmpQZFhfZ0xLUXhTMk1ybS1VNFpfbmgyNklXVkhlUmEtLTVsQlplTzNXZGo1TVlFNEhEWjdZVU1zV0VpZk4tMzE4ZV90ZkhDaUhYaUJVNkZlMkl4dktTQW5iSmRWdWdJNlFHYVY2eXFpd2NvbGlYREZkRmRCbHBmTU1pYkxYUzFITWxtX0o4dVpOdlJTYTlMd2tCRlVTN1VucFJLdHRna1V6aDFWM29ySzVTS3hTLVEtWHd4M2M4X1pEQXg1TjVfd0NKQi1PQkdyLWJDSHRpZ3F4dlRyd29jdGI3Wkp2Z2ZWbVlQMzM1U1RwRXgxY3o2VXRjdjEyMnBJWG0wX1BUOU40ZW0wSnIzSDVvNEk2Yk9pQjJZd0VmRGNLUlBKeEpTYlJweGExMVJoa2w4YW01aG9sWVdQR1lZWl9xc09zUjQtWUZNM2hiQXhDNWR1aWlkdnpNdEdTdFhPeklKZ1Ffc0VESDU3OHJQMjRheDhiWG5rTTV0MWVySHdYTmw2WEdZRXNUY2pleTFmZ3R5RjBRSlA0MmhCeXZwV3BKYk9BWDBnRHlSQUVPRGdfckxUWFA5OWJTMGN3YWh3OENpRjJ0S01fVTlwOW5jMDh4S1lSWGNVODBLMWhnNzdINTNKaWN3c0ZZWkhRZUVLdzBaWU80S2FGYzdQVGxoajFxUFhuNUhmSk82aGx0cDhtR1JyaWoxTTQxWU1JcjFSOTgyS1dxRlB6bFFzbDNlNjNPUEh4aXZ5QzBncS0xei1B","email":"rspazzol@redhat.com"}}}

set -o nounset
set -o errexit

function download_installer()
{
wget https://github.com/openshift/installer/releases/download/${INSTALLER_VERSION}/openshift-install-linux-amd64 -O /usr/local/bin/openshift-install
chmod +x /usr/local/bin/openshift-install
}

function configure_aws_credentials()
{
mkdir -p ~/.aws
cat << EOF >  ~/.aws/credentials
[default]
aws_access_key_id = AKIAIW4Q52VJD44H2T4Q
aws_secret_access_key = 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
EOF
}

function create_openshift()
{
  mkdir -p ./cluster$CLUSTER_ID
  cp ./config/install-config-raffa$CLUSTER_ID.yaml ./cluster$CLUSTER_ID/install-config.yaml
  openshift-install create cluster --dir ./cluster$CLUSTER_ID
}

#download_installer
#configure_aws_credentials
CLUSTER_ID=1 create_openshift 
#CLUSTER_ID=2 create_openshift 